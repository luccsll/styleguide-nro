import{formatDateInfo}from"../src/utils.js";export function _setStep(t,e,n){const s=t;s.empty(),e.forEach(((t,e)=>{const n=new Date(t.deadline),{resultDate:o,progressWidth:a,barColor:i}=formatDateInfo(n);let l=`\n        <li class="stepNro" data-id="${e+1}" data-deadline="${t.deadline}">\n            <span class="infoClickHover" data-id="${e+1}">Clique aqui para mais informações</span>\n            <div class="progress progressNro">\n                <div class="progress-bar progressBarNro"\n                     role="progressbar"\n                     data-target="${a}"\n                     data-color="${i}"\n                     aria-valuemin="0" aria-valuemax="100"\n                     style="width:0%">\n                </div>\n            </div>\n            <div class="stepContent">\n                <h2 class="stepContentActivity">${t.activity}</h2>\n                <div class="stepContentInfo">`;var d="";t.responsible&&(d=t.responsible.length>14?t.responsible.substring(0,14)+"...":t.responsible),null==t.responsible?l+=`<p class="stepContentOwner" style="visibility: hidden;">${d}</p>`:l+=`<p class="stepContentOwner">${d}</p>`,null==t.deadline?l+=`<p class="stepContentDeadline" style="visibility: hidden;"><span class="stepContentTime">${o}</span></p>`:l+=`<p class="stepContentDeadline"><span class="stepContentTime">${o}</span></p>`,l+="</div></div></li>",s.append(l)})),$(".infoClickHover").on("click",(function(){const t=$(this).data("id"),s=e[t-1],o=`\n            <div class="backgroundModal" id="modalStep${t}">\n                <div class="contentModal">\n                    <div class="contentModalHeader">\n                        <h1 class="contentModalTitle">${s.activity} <button class="buttonCloseModalStep"><i class="flaticon flaticon-close icon-md" aria-hidden="true"></i></button></h1>\n                        <p class="contentModalSubtitle">${n[0].nameProcess}</p>\n                    </div>\n                    <div class="contentModalBody">\n                        <div class="contentModalRow">\n                            <div class="contentModalItem">\n                                <p class="subtitleModalItem">Descrição da etapa</p>\n                                <p class="textContentModal">${s.description}</p>\n                            </div>\n                            <div class="contentModalItem">\n                                <p class="subtitleModalItem">Prazo de atendimento</p>\n                                <p class="textContentModal">${s.deadline?new Date(s.deadline).toLocaleString():"Sem prazo definido"}</p>\n                            </div>\n                        </div>\n                        <div class="contentModalRow">\n                            <div class="contentModalItem">\n                                <p class="subtitleModalItem">Responsável pela etapa</p>\n                                <div class="contentModalItem-profile">\n                                    <img src="ft.png" class="photoModalStep">\n                                    <div class="contentModalItem-text">\n                                        <a class="modalStepName" href="https://concessionariarota156340.fluig.cloudtotvs.com.br:1700/portal/p/1/social/lucassilva" target="_blank">${s.responsible||"Não definido"}</a>\n                                         ${"user"===s.typeResponsible?'<p class="modalStepPosition">Usuário</p>':""}\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;$("body").append(o),$("#modalStep"+t).show(),$(".buttonCloseModalStep").on("click",(function(){$("#modalStep"+t).remove()}))}))}export function _setStepActive(t,e){let n=600;for(let s of t.children()){const t=$(s);t.removeClass("stepActiveNro"),setTimeout((()=>{const n=t.data("id"),s=t.find(".progressBarNro"),o=t.data("deadline");if(n<e)t.addClass("stepCompletNro");else if(n===e&&(t.addClass("stepActiveNro"),!o))return void s.css({width:"100%",backgroundColor:"white"});const a=new Date(o),i=new Date;if(n<e)s.css("width","100%"),setTimeout((()=>{t.find(".stepContentDeadline").text("Concluído")}),1900);else if(n===e){const t=new Date(i.getFullYear(),i.getMonth(),i.getDate()),e=a.getTime()-t.getTime(),n=i.getTime()-t.getTime();let o=0,l="white";if(i>=a)o=100,l="var(--color-danger) !important";else{o=(n/e*100).toFixed(1);const t=100-o;l=t>50?"white":t>15?"var(--color-warning) !important":t>0?"var(--color-nro-06) !important":"var(--color-danger) !important"}s.css({width:`${o}%`,backgroundColor:l})}}),n),n+=1900}}